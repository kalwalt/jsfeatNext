!function(t,a){"object"==typeof exports&&"object"==typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?exports.jsfeatNext=a():t.jsfeatNext=a()}(this,(()=>(()=>{"use strict";var t={d:(a,e)=>{for(var i in e)t.o(e,i)&&!t.o(a,i)&&Object.defineProperty(a,i,{enumerable:!0,get:e[i]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)},a={};function e(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function i(t,a){for(var e=0;e<a.length;e++){var i=a[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,a,e){return a&&i(t.prototype,a),e&&i(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}t.d(a,{default:()=>k});var o=function(){function t(){e(this,t),this._data_type_size=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8])}return r(t,[{key:"_get_data_type",value:function(t){return 65280&t}},{key:"_get_channel",value:function(t){return 255&t}},{key:"_get_data_type_size",value:function(t){return this._data_type_size[(65280&t)>>8]}}]),t}(),s=r((function t(a,i){e(this,t),this.size=-8&(a+7|0),void 0===i?this.buffer=new ArrayBuffer(this.size):(this.buffer=i,this.size=i.length),this.u8=new Uint8Array(this.buffer),this.i32=new Int32Array(this.buffer),this.f32=new Float32Array(this.buffer),this.f64=new Float64Array(this.buffer)})),n=function(){function t(a){e(this,t),this.next=null,this.data=new s(a),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64}return r(t,[{key:"resize",value:function(){delete this.data,this.data=new s(size_in_bytes),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64}}]),t}(),h=function(){function t(){e(this,t),this._pool_head,this._pool_tail,this._pool_size=0}return r(t,[{key:"allocate",value:function(t,a){this._pool_head=this._pool_tail=new n(a);for(var e=0;e<t;++e){var i=new n(a);this._pool_tail=this._pool_tail.next=i,this._pool_size++}}},{key:"get_buffer",value:function(t){var a=this._pool_head;return this._pool_head=this._pool_head.next,this._pool_size--,t>a.size&&a.resize(t),a}},{key:"put_buffer",value:function(t){this._pool_tail=this._pool_tail.next=t,this._pool_size++}}]),t}(),u=r((function t(a,i,r,f,o){e(this,t),void 0===a&&(a=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===f&&(f=0),void 0===o&&(o=-1),this.x=a,this.y=i,this.score=r,this.level=f,this.angle=o})),c=1.192092896e-7,d=1024,_=function(){function t(){e(this,t)}return r(t,[{key:"grayscale",value:function(t,a,e,i,r){void 0===r&&(r=0);var f=0,o=0,s=0,n=0,h=0,u=0,c=4899,d=9617,_=1868,l=4;2!=r&&3!=r||(c=1868,_=4899),1!=r&&3!=r||(l=3);var v=l<<1,p=3*l|0;i.resize(a,e,1);var y=i.data;for(o=0;o<e;++o,n+=a,s+=a*l){for(f=0,h=s,u=n;f<=a-4;f+=4,h+=l<<2,u+=4)y[u]=t[h]*c+t[h+1]*d+t[h+2]*_+8192>>14,y[u+1]=t[h+l]*c+t[h+l+1]*d+t[h+l+2]*_+8192>>14,y[u+2]=t[h+v]*c+t[h+v+1]*d+t[h+v+2]*_+8192>>14,y[u+3]=t[h+p]*c+t[h+p+1]*d+t[h+p+2]*_+8192>>14;for(;f<a;++f,++u,h+=l)y[u]=t[h]*c+t[h+1]*d+t[h+2]*_+8192>>14}}},{key:"pyrdown",value:function(t,a,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var r=t.cols,f=r>>1,o=t.rows>>1,s=f-(e<<1),n=o-(i<<1),h=0,u=0,c=e+i*r,d=0,_=0,l=0;a.resize(f,o,t.channel);var v=t.data,p=a.data;for(u=0;u<n;++u){for(d=c,l=_,h=0;h<=s-2;h+=2,l+=2,d+=4)p[l]=v[d]+v[d+1]+v[d+r]+v[d+r+1]+2>>2,p[l+1]=v[d+2]+v[d+3]+v[d+r+2]+v[d+r+3]+2>>2;for(;h<s;++h,++l,d+=2)p[l]=v[d]+v[d+1]+v[d+r]+v[d+r+1]+2>>2;c+=r<<1,_+=f}}},{key:"warp_affine",value:function(t,a,e,i){void 0===i&&(i=0);for(var r=t.cols,f=t.rows,o=a.cols,s=a.rows,n=t.data,h=a.data,u=0,c=0,d=0,_=0,l=0,v=0,p=0,y=0,b=0,w=0,m=0,k=e.data,g=k[0],x=k[1],M=k[2],z=k[3],C=k[4],A=k[5],O=0;c<s;++c)for(v=x*c+M,p=C*c+A,u=0;u<o;++u,++O,v+=g,p+=z)l=0|p,(_=0|v)>=0&&l>=0&&_<r-1&&l<f-1?(y=v-_,b=p-l,w=n[d=r*l+_]+y*(n[d+1]-n[d]),m=n[d+r]+y*(n[d+r+1]-n[d+r]),h[O]=w+b*(m-w)):h[O]=i}}]),t}(),l=function(){function t(){e(this,t)}return r(t,[{key:"identity",value:function(t,a){void 0===a&&(a=1);for(var e=t.data,i=t.rows,r=t.cols,f=r+1|0,o=i*r,s=o;--o>=0;)e[o]=0;for(o=s,s=0;s<o;)e[s]=a,s+=f}},{key:"transpose",value:function(t,a){for(var e=0,i=0,r=a.rows,f=a.cols,o=0,s=0,n=0,h=a.data,u=t.data;e<r;s+=1,o+=f,e++)for(n=s,i=0;i<f;n+=r,i++)u[n]=h[o+i]}},{key:"multiply",value:function(t,a,e){for(var i=0,r=0,f=0,o=0,s=0,n=0,h=0,u=0,c=a.cols,d=a.rows,_=e.cols,l=a.data,v=e.data,p=t.data,y=0;i<d;o+=c,i++)for(h=0,r=0;r<_;u++,h++,r++){for(n=h,s=o,y=0,f=0;f<c;s++,n+=_,f++)y+=l[s]*v[n];p[u]=y}}},{key:"multiply_ABt",value:function(t,a,e){for(var i=0,r=0,f=0,o=0,s=0,n=0,h=0,u=a.cols,c=a.rows,d=e.rows,_=a.data,l=e.data,v=t.data,p=0;i<c;o+=u,i++)for(n=0,r=0;r<d;h++,r++){for(s=o,p=0,f=0;f<u;s++,n++,f++)p+=_[s]*l[n];v[h]=p}}},{key:"multiply_AtB",value:function(t,a,e){for(var i=0,r=0,f=0,o=0,s=0,n=0,h=0,u=0,c=a.cols,d=a.rows,_=e.cols,l=a.data,v=e.data,p=t.data,y=0;i<c;o++,i++)for(h=0,r=0;r<_;u++,h++,r++){for(n=h,s=o,y=0,f=0;f<d;s+=c,n+=_,f++)y+=l[s]*v[n];p[u]=y}}},{key:"multiply_AAt",value:function(t,a){for(var e=0,i=0,r=0,f=0,o=0,s=0,n=0,h=0,u=0,c=a.cols,d=a.rows,_=a.data,l=t.data,v=0;e<d;f+=d+1,o=s,e++)for(h=f,u=f,n=o,i=e;i<d;h++,u+=d,i++){for(s=o,v=0,r=0;r<c;r++)v+=_[s++]*_[n++];l[h]=v,l[u]=v}}},{key:"multiply_AtA",value:function(t,a){for(var e=0,i=0,r=0,f=0,o=0,s=0,n=0,h=0,u=0,c=a.cols,d=a.rows,_=a.data,l=t.data,v=0;e<c;n+=c,e++)for(f=e,h=u=n+e,i=e;i<c;h++,u+=c,i++){for(o=f,s=i,v=0,r=0;r<d;o+=c,s+=c,r++)v+=_[o]*_[s];l[h]=v,l[u]=v}}},{key:"identity_3x3",value:function(t,a){void 0===a&&(a=1);var e=t.data;e[0]=e[4]=e[8]=a,e[1]=e[2]=e[3]=0,e[5]=e[6]=e[7]=0}},{key:"invert_3x3",value:function(t,a){var e=t.data,i=a.data,r=e[4],f=e[8],o=e[5],s=e[7],n=e[0],h=n*r,u=n*o,c=e[3],d=e[1],_=c*d,l=e[2],v=c*l,p=e[6],y=p*d,b=p*l,w=1/(h*f-u*s-_*f+v*s+y*o-b*r);i[0]=(r*f-o*s)*w,i[1]=-(d*f-l*s)*w,i[2]=-(-d*o+l*r)*w,i[3]=-(c*f-o*p)*w,i[4]=(n*f-b)*w,i[5]=-(u-v)*w,i[6]=-(-c*s+r*p)*w,i[7]=-(n*s-y)*w,i[8]=(h-_)*w}},{key:"multiply_3x3",value:function(t,a,e){var i=t.data,r=a.data,f=e.data,o=r[0],s=r[1],n=r[2],h=r[3],u=r[4],c=r[5],d=r[6],_=r[7],l=r[8],v=f[0],p=f[1],y=f[2],b=f[3],w=f[4],m=f[5],k=f[6],g=f[7],x=f[8];i[0]=o*v+s*b+n*k,i[1]=o*p+s*w+n*g,i[2]=o*y+s*m+n*x,i[3]=h*v+u*b+c*k,i[4]=h*p+u*w+c*g,i[5]=h*y+u*m+c*x,i[6]=d*v+_*b+l*k,i[7]=d*p+_*w+l*g,i[8]=d*y+_*m+l*x}},{key:"mat3x3_determinant",value:function(t){var a=t.data;return a[0]*a[4]*a[8]-a[0]*a[5]*a[7]-a[3]*a[1]*a[8]+a[3]*a[2]*a[7]+a[6]*a[1]*a[5]-a[6]*a[2]*a[4]}},{key:"determinant_3x3",value:function(t,a,e,i,r,f,o,s,n){return t*r*n-t*f*s-i*a*n+i*e*s+o*a*f-o*e*r}}]),t}(),v=function(){function t(a,i,r,f){e(this,t),this.dt=new o,this.type=0|this.dt._get_data_type(r),this.channel=0|this.dt._get_channel(r),this.cols=0|a,this.rows=0|i,void 0===f?this.allocate():(this.buffer=f,this.data=256&this.type?this.buffer.u8:512&this.type?this.buffer.i32:this.type&d?this.buffer.f32:this.buffer.f64)}return r(t,[{key:"allocate",value:function(){delete this.data,delete this.buffer,this.buffer=new s(this.cols*this.dt._get_data_type_size(this.type)*this.channel*this.rows),this.data=256&this.type?this.buffer.u8:512&this.type?this.buffer.i32:this.type&d?this.buffer.f32:this.buffer.f64}},{key:"copy_to",value:function(t){for(var a=t.data,e=this.data,i=0,r=this.cols*this.rows*this.channel|0;i<r-4;i+=4)a[i]=e[i],a[i+1]=e[i+1],a[i+2]=e[i+2],a[i+3]=e[i+3];for(;i<r;++i)a[i]=e[i]}},{key:"resize",value:function(t,a,e){void 0===e&&(e=this.channel),t*this.dt._get_data_type_size(this.type)*e*a>this.buffer.size?(this.cols=t,this.rows=a,this.channel=e,this.allocate()):(this.cols=t,this.rows=a,this.channel=e)}}]),t}(),p=function(){function t(){e(this,t)}return r(t,[{key:"cconstructor",value:function(t){this.levels=0|t,this.data=new Array(t),this.pyrdown=new _.pyrdown}},{key:"allocate",value:function(t,a,e){for(var i=this.levels;--i>=0;)this.data[i]=new jsfeatNext.matrix_t(t>>i,a>>i,e)}},{key:"build",value:function(t,a){void 0===a&&(a=!0);var e=2,i=t,r=this.data[0];if(!a)for(var f=t.cols*t.rows;--f>=0;)r.data[f]=t.data[f];for(r=this.data[1],this.pyrdown(i,r);e<this.levels;++e)i=r,r=this.data[e],this.pyrdown(i,r)}}]),t}();function y(t,a,e,i){i=t[a],t[a]=t[e],t[e]=i}function b(t,a){return(t=Math.abs(t))>(a=Math.abs(a))?(a/=t,t*Math.sqrt(1+a*a)):a>0?(t/=a,a*Math.sqrt(1+t*t)):0}var w=function(){function t(){e(this,t),this.cache=new h,this.cache.allocate(30,2560),this.matmath=new l}return r(t,[{key:"JacobiImpl",value:function(t,a,e,i,r,f){var o=0,s=0,n=0,h=0,u=0,c=0,d=0,_=0,l=0,v=f*f*30,p=0,w=0,m=0,k=0,g=0,x=0,M=0,z=0,C=0,A=this.cache.get_buffer(f<<2),O=this.cache.get_buffer(f<<2),R=A.i32,S=O.i32;if(i)for(;o<f;o++){for(n=o*r,s=0;s<f;s++)i[n+s]=0;i[n+o]=1}for(n=0;n<f;n++){if(e[n]=t[(a+1)*n],n<f-1){for(h=n+1,p=Math.abs(t[a*n+h]),o=n+2;o<f;o++)p<(w=Math.abs(t[a*n+o]))&&(p=w,h=o);R[n]=h}if(n>0){for(h=0,p=Math.abs(t[n]),o=1;o<n;o++)p<(w=Math.abs(t[a*o+n]))&&(p=w,h=o);S[n]=h}}if(f>1)for(;l<v;l++){for(n=0,p=Math.abs(t[R[0]]),o=1;o<f-1;o++)p<(w=Math.abs(t[a*o+R[o]]))&&(p=w,n=o);for(u=R[n],o=1;o<f;o++)p<(w=Math.abs(t[a*S[o]+o]))&&(p=w,n=S[o],u=o);if(m=t[a*n+u],Math.abs(m)<=1.192092896e-7)break;for(k=.5*(e[u]-e[n]),M=(g=Math.abs(k)+b(m,k))/(x=b(m,g)),x=m/x,g=m/g*m,k<0&&(x=-x,g=-g),t[a*n+u]=0,e[n]-=g,e[u]+=g,o=0;o<n;o++)_=a*o+u,z=t[d=a*o+n],C=t[_],t[d]=z*M-C*x,t[_]=z*x+C*M;for(o=n+1;o<u;o++)_=a*o+u,z=t[d=a*n+o],C=t[_],t[d]=z*M-C*x,t[_]=z*x+C*M;for(d=a*n+(o=u+1),_=a*u+o;o<f;o++,d++,_++)z=t[d],C=t[_],t[d]=z*M-C*x,t[_]=z*x+C*M;if(i)for(d=r*n,_=r*u,o=0;o<f;o++,d++,_++)z=i[d],C=i[_],i[d]=z*M-C*x,i[_]=z*x+C*M;for(s=0;s<2;s++){if((c=0==s?n:u)<f-1){for(h=c+1,p=Math.abs(t[a*c+h]),o=c+2;o<f;o++)p<(w=Math.abs(t[a*c+o]))&&(p=w,h=o);R[c]=h}if(c>0){for(h=0,p=Math.abs(t[c]),o=1;o<c;o++)p<(w=Math.abs(t[a*o+c]))&&(p=w,h=o);S[c]=h}}}for(n=0;n<f-1;n++){for(h=n,o=n+1;o<f;o++)e[h]<e[o]&&(h=o);if(n!=h&&(y(e,h,n,p),i))for(o=0;o<f;o++)y(i,r*h+o,r*n+o,p)}this.cache.put_buffer(A),this.cache.put_buffer(O)}},{key:"JacobiSVDImpl",value:function(t,a,e,i,r,f,o,s){for(var n=0,h=0,u=0,c=0,d=Math.max(f,30),_=0,l=0,v=0,p=0,w=0,m=0,k=0,g=0,x=0,M=0,z=0,C=0,A=0,O=0,R=0,S=0,j=0,F=4660,U=0,B=0,I=0,G=this.cache.get_buffer(o<<3),L=G.f64;n<o;n++){for(u=0,z=0;u<f;u++)z+=(g=t[n*a+u])*g;if(L[n]=z,i){for(u=0;u<o;u++)i[n*r+u]=0;i[n*r+n]=1}}for(;c<d;c++){for(w=0,n=0;n<o-1;n++)for(h=n+1;h<o;h++){for(_=n*a|0,l=h*a|0,R=L[n],S=0,j=L[h],u=2,S+=t[_]*t[l],S+=t[_+1]*t[l+1];u<f;u++)S+=t[_+u]*t[l+u];if(!(Math.abs(S)<=2.384185792e-7*Math.sqrt(R*j))){for(A=b(S*=2,C=R-j),C<0?(O=.5*(A-C),m=S/(A*(k=Math.sqrt(O/A))*2)):k=S/(A*(m=Math.sqrt((A+C)/(2*A)))*2),R=0,j=0,u=2,x=m*t[_]+k*t[l],M=-k*t[_]+m*t[l],t[_]=x,t[l]=M,R+=x*x,j+=M*M,x=m*t[_+1]+k*t[l+1],M=-k*t[_+1]+m*t[l+1],t[_+1]=x,t[l+1]=M,R+=x*x,j+=M*M;u<f;u++)x=m*t[_+u]+k*t[l+u],M=-k*t[_+u]+m*t[l+u],t[_+u]=x,t[l+u]=M,R+=x*x,j+=M*M;if(L[n]=R,L[h]=j,w=1,i)for(p=h*r|0,u=2,x=m*i[v=n*r|0]+k*i[p],M=-k*i[v]+m*i[p],i[v]=x,i[p]=M,x=m*i[v+1]+k*i[p+1],M=-k*i[v+1]+m*i[p+1],i[v+1]=x,i[p+1]=M;u<o;u++)x=m*i[v+u]+k*i[p+u],M=-k*i[v+u]+m*i[p+u],i[v+u]=x,i[p+u]=M}}if(0==w)break}for(n=0;n<o;n++){for(u=0,z=0;u<f;u++)z+=(g=t[n*a+u])*g;L[n]=Math.sqrt(z)}for(n=0;n<o-1;n++){for(h=n,u=n+1;u<o;u++)L[h]<L[u]&&(h=u);if(n!=h&&(y(L,n,h,z),i)){for(u=0;u<f;u++)y(t,n*a+u,h*a+u,g);for(u=0;u<o;u++)y(i,n*r+u,h*r+u,g)}}for(n=0;n<o;n++)e[n]=L[n];if(i){for(n=0;n<s;n++){for(z=n<o?L[n]:0;z<=1e-37;){for(B=1/f,u=0;u<f;u++)U=0!=(256&(F=214013*F+2531011)>>16)?B:-B,t[n*a+u]=U;for(c=0;c<2;c++)for(h=0;h<n;h++){for(z=0,u=0;u<f;u++)z+=t[n*a+u]*t[h*a+u];for(I=0,u=0;u<f;u++)g=t[n*a+u]-z*t[h*a+u],t[n*a+u]=g,I+=Math.abs(g);for(I=I?1/I:0,u=0;u<f;u++)t[n*a+u]*=I}for(z=0,u=0;u<f;u++)z+=(g=t[n*a+u])*g;z=Math.sqrt(z)}for(k=1/z,u=0;u<f;u++)t[n*a+u]*=k}this.cache.put_buffer(G)}else this.cache.put_buffer(G)}},{key:"lu_solve",value:function(t,a){var e,i,r,f,o=0,s=0,n=0,h=1,u=t.cols,d=t.data,_=a.data;for(o=0;o<u;o++){for(n=o,s=o+1;s<u;s++)Math.abs(d[s*u+o])>Math.abs(d[n*u+o])&&(n=s);if(Math.abs(d[n*u+o])<c)return 0;if(n!=o){for(s=o;s<u;s++)y(d,o*u+s,n*u+s,e);y(_,o,n,e),h=-h}for(r=-1/d[o*u+o],s=o+1;s<u;s++){for(i=d[s*u+o]*r,n=o+1;n<u;n++)d[s*u+n]+=i*d[o*u+n];_[s]+=i*_[o]}d[o*u+o]=-r}for(o=u-1;o>=0;o--){for(f=_[o],n=o+1;n<u;n++)f-=d[o*u+n]*_[n];_[o]=f*d[o*u+o]}return 1}},{key:"cholesky_solve",value:function(t,a){var e,i,r=0,f=0,o=0,s=0,n=0,h=0,u=0,c=t.cols,d=t.data,_=a.data;for(r=0;r<c;r++)for(i=1,n=s=r*c,f=r;f<c;f++){for(e=d[n+r],o=0;o<r;o++)e-=d[o*c+r]*d[n+o];if(f==r){if(d[n+r]=e,0==e)return 0;i=1/e}else d[s+f]=e,d[n+r]=e*i;n+=c}for(s=0,h=0;h<c;h++){for(e=_[h],u=0;u<h;u++)e-=d[s+u]*_[u];_[h]=e,s+=c}for(s=0,h=0;h<c;h++)_[h]/=d[s+h],s+=c;for(h=c-1;h>=0;h--){for(e=_[h],s=(u=h+1)*c;u<c;u++)e-=d[s+h]*_[u],s+=c;_[h]=e}return 1}},{key:"svd_decompose",value:function(t,a,e,i,r){void 0===r&&(r=0);var f=0,o=0,s=t.rows,n=t.cols,h=s,u=n,c=1|t.type;h<u&&(f=1,o=h,h=u,u=o);var d=this.cache.get_buffer(h*h<<3),_=this.cache.get_buffer(u<<3),l=this.cache.get_buffer(u*u<<3),v=new m.matrix_t(h,h,c,d.data),p=new m.matrix_t(1,u,c,_.data),y=new m.matrix_t(u,u,c,l.data);if(0==f)this.matmath.transpose(v,t);else{for(o=0;o<n*s;o++)v.data[o]=t.data[o];for(;o<u*h;o++)v.data[o]=0}if(this.JacobiSVDImpl(v.data,h,p.data,y.data,u,h,u,h),a){for(o=0;o<u;o++)a.data[o]=p.data[o];for(;o<n;o++)a.data[o]=0}if(0==f){if(e&&1&r)for(o=h*h;--o>=0;)e.data[o]=v.data[o];else e&&this.matmath.transpose(e,v);if(i&&2&r)for(o=u*u;--o>=0;)i.data[o]=y.data[o];else i&&this.matmath.transpose(i,y)}else{if(e&&1&r)for(o=u*u;--o>=0;)e.data[o]=y.data[o];else e&&this.matmath.transpose(e,y);if(i&&2&r)for(o=h*h;--o>=0;)i.data[o]=v.data[o];else i&&this.matmath.transpose(i,v)}this.cache.put_buffer(d),this.cache.put_buffer(_),this.cache.put_buffer(l)}},{key:"svd_solve",value:function(t,a,e){var i,r=0,f=0,o=0,s=0,n=0,h=t.rows,u=t.cols,d=0,_=0,l=1|t.type,v=this.cache.get_buffer(h*h<<3),p=this.cache.get_buffer(u<<3),y=this.cache.get_buffer(u*u<<3),b=new m.matrix_t(h,h,l,v.data),w=new m.matrix_t(1,u,l,p.data),k=new m.matrix_t(u,u,l,y.data),g=e.data,x=b.data,M=w.data,z=k.data;for(this.svd_decompose(t,w,b,k,0),i=c*M[0]*u;r<u;r++,n+=u){for(_=0,f=0;f<u;f++)if(M[f]>i){for(o=0,d=0,s=0;o<h;o++,s+=u)d+=x[s+f]*g[o];_+=d*z[n+f]/M[f]}a.data[r]=_}this.cache.put_buffer(v),this.cache.put_buffer(p),this.cache.put_buffer(y)}},{key:"svd_invert",value:function(t,a){var e,i=0,r=0,f=0,o=0,s=0,n=0,h=a.rows,u=a.cols,d=0,_=1|a.type,l=this.cache.get_buffer(h*h<<3),v=this.cache.get_buffer(u<<3),p=this.cache.get_buffer(u*u<<3),y=new m.matrix_t(h,h,_,l.data),b=new m.matrix_t(1,u,_,v.data),w=new m.matrix_t(u,u,_,p.data),k=t.data,g=y.data,x=b.data,M=w.data;for(this.svd_decompose(a,b,y,w,0),e=c*x[0]*u;i<u;i++,s+=u)for(r=0,o=0;r<h;r++,n++){for(f=0,d=0;f<u;f++,o++)x[f]>e&&(d+=M[s+f]*g[o]/x[f]);k[n]=d}this.cache.put_buffer(l),this.cache.put_buffer(v),this.cache.put_buffer(p)}},{key:"eigenVV",value:function(t,a,e){for(var i=t.cols,r=i*i,f=1|t.type,o=this.cache.get_buffer(i*i<<3),s=this.cache.get_buffer(i<<3),n=new m.matrix_t(i,i,f,o.data),h=new m.matrix_t(1,i,f,s.data);--r>=0;)n.data[r]=t.data[r];if(JacobiImpl(n.data,i,h.data,a?a.data:null,i,i),e)for(;--i>=0;)e.data[i]=h.data[i];this.cache.put_buffer(o),this.cache.put_buffer(s)}}]),t}(),m=function(){function t(){e(this,t),this.dt=new o}return r(t,[{key:"get_data_type",value:function(t){return this.dt._get_data_type(t)}},{key:"get_channel",value:function(t){return this.dt._get_channel(t)}},{key:"get_data_type_size",value:function(t){return this.dt._get_data_type_size(t)}}]),t}();f(m,"VERSION","0.3.0"),f(m,"EPSILON",c),f(m,"FLT_MIN",1e-37),f(m,"U8_t",256),f(m,"S32_t",512),f(m,"F32_t",d),f(m,"S64_t",2048),f(m,"F64_t",4096),f(m,"F64_t",4096),f(m,"C1_t",1),f(m,"C2_t",2),f(m,"C3_t",3),f(m,"C4_t",4),f(m,"COLOR_RGBA2GRAY",0),f(m,"COLOR_RGB2GRAY",0),f(m,"COLOR_BGRA2GRAY",0),f(m,"COLOR_BGR2GRAY",0),f(m,"BOX_BLUR_NOSCALE",1),f(m,"SVD_U_T",1),f(m,"SVD_V_T",2),f(m,"U8C1_t",m.U8_t|m.C1_t),f(m,"U8C3_t",m.U8_t|m.C3_t),f(m,"U8C4_t",m.U8_t|m.C4_t),f(m,"F32C1_t",m.F32_t|m.C1_t),f(m,"F32C2_t",m.F32_t|m.C2_t),f(m,"S32C1_t",m.S32_t|m.C1_t),f(m,"S32C2_t",m.S32_t|m.C2_t),m.data_t=s,m.matrix_t=v,m.pyramid_t=p,m.keypoint_t=u,m.cache=h,m.imgproc=_,m.matmath=l,m.linalg=w;const k={jsfeatNext:m};return a.default})()));